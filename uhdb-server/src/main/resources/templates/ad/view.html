<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" layout:decorate="~{layout/layout}">
<head>
<title>광고 상세보기</title>
<!-- page script -->
<script type="text/javascript" th:inline="javascript">
/*<![CDATA[*/

$(document).ready(function() {
    // Date picker
    $("#_startDate").datepicker({
      autoclose: true
      , format: "yyyymmdd"
      , language: "kr"
    });
    $("#_endDate").datepicker({
        autoclose: true
        , format: "yyyymmdd"
        , language: "kr"
    });

	$("#targetUrl").inputmask("http://*{1,10}.*{1,10}.*{2,4}");

    $("#form-ad-reg").submit(function() {
    	var startDateVal = $("#_startDate").val(); // 일단 시간은 생략
    	var endDateVal = $("#_endDate").val(); // 일단 시간은 생략

    	if (parseInt(endDateVal, 10) <= parseInt(startDateVal, 10)) {
			alert(" 광고 종료일을 시작일 이후 날짜로 선택하세요. ");
           	return false;
    	}

    	$("#startDate").val(startDateVal + "000000");
    	$("#endDate").val(endDateVal + "235959");
    });

	if ($("#delYn").val() == 'Y') {
		$("#title").prop("disabled", true);
		$("#_startDate").prop("disabled", true);
		$("#_endDate").prop("disabled", true);
		$("#targetUrl").prop("disabled", true);
		$("#cb-del-yn").prop("checked", true);
	}

	$("#cb-del-yn").click(function() {
		if ($("#cb-del-yn").prop("checked")) { // 삭제
			$("#title").prop("disabled", true);
			$("#_startDate").prop("disabled", true);
			$("#_endDate").prop("disabled", true);
			$("#targetUrl").prop("disabled", true);
			$("#delYn").val('Y');
		}
		else {
			$("#title").prop("disabled", false);
			$("#_startDate").prop("disabled", false);
			$("#_endDate").prop("disabled", false);
			$("#targetUrl").prop("disabled", false);
			$("#delYn").val('N');
		}
	});
});

/*]]>*/
</script>
</head>
<body>

  <!--// 본문 영역 -->
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper" layout:fragment="content">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        광고 관리
        <small>광고 상세보기</small>
      </h1>
<!--
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="#">Tables</a></li>
        <li class="active">Data tables</li>
      </ol>
-->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="row">
        <div class="col-xs-10">
          <div class="box box-primary">
            <div class="box-header with-border">
              <!--<h3 class="box-title"> Hover Data Table</h3>-->
            </div>
 			<form id="form-ad-modify" name="form-ad-modify" enctype="multipart/form-data" role="form" class="form-horizontal" method="post" action="#" th:action="@{/ad/modify/} + ${ad.seq}">
 			  <input type="hidden" id="shopSeq" name="shopSeq" value="" th:value="${shop.seq}" />
              <div class="box-body">
                <div class="form-group">
                  <label class="col-sm-2 control-label">광고주명</label>
                  <div class="col-sm-4">
                  	<input type="text" class="form-control" id="_sponsorName" name="_sponsorName" readonly="readonly" th:value="${sponsor.name}" />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">매장명</label>
                  <div class="col-sm-4">
                  	<input type="text" class="form-control" id="_shopName" name="_shopName" readonly="readonly" th:value="${shop.name}" />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">광고타이틀</label>
                  <div class="col-sm-9">
                  	<input type="text" class="form-control" id="title" name="title" placeholder="광고타이틀" required="required" th:value="${ad.title}" />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">광고시작일</label>
				  <div class="col-sm-2">
					  <div class="input-group date">
	                  	<div class="input-group-addon">
	                    	<i class="fa fa-calendar"></i>
	                  	</div>
	                  	<input type="text" class="form-control pull-right" id="_startDate" name="_startDate" placeholder="광고시작일" required="required" th:value="${#strings.substring(ad.startDate, 0, 8)}" />
	                  </div>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">광고종료일</label>
				  <div class="col-sm-2">
					  <div class="input-group date">
	                  	<div class="input-group-addon">
	                    	<i class="fa fa-calendar"></i>
	                  	</div>
	                  	<input type="text" class="form-control pull-right" id="_endDate" name="_endDate" placeholder="광고종료일" required="required" th:value="${#strings.substring(ad.endDate, 0, 8)}" />
	                  </div>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">타겟URL</label>
                  <div class="col-sm-4">
                  	<input type="text" id="targetUrl" name="targetUrl" class="form-control" placeholder="타겟 URL" th:value="${ad.targetUrl}" />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">광고 이미지<span class="badge" style="display: none;">0</span></label>
                  <div class="col-sm-9">
                  	<!--// 파일업로드 처리 -->
	                <input type="file" id="attachFile" name="attachFile" onchange="uploadFile(this, 1, 1);" style="margin-bottom:5px;" />

					<div class="progress" style="display: none;">
						<div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
					</div>

					<ul id="_ul_uploaded_files_area">
						<li style="padding-top: 5px;" th:if="${not #lists.isEmpty(attachFileList)}" th:each="attachFile,iterStat : ${attachFileList}">
							<span th:id="'span_file_name_' + ${attachFile.fileSeq}" th:text="${attachFile.orgName}">파일명</span>
							<span th:text="'(' + ${#numbers.formatInteger(attachFile.size, 3, 'COMMA')} + 'KB)'">파일사이즈</span> &nbsp;
							<button class="btn btn-xs btn-danger" th:onclick="'deleteUploadedFile(this, ' + ${attachFile.fileSeq} + ')'" type="button">삭제</button>
							<a class="btn btn-xs btn-info" data-toggle="modal" data-target="#image-view-modal" th:data-target="'#image-view-modal-' + ${attachFile.fileSeq}">보기</a>

					        <div class="modal fade" tabindex="-1" role="dialog" aria-hidden="true" id="image-view-modal" th:id="'image-view-modal-' + ${attachFile.fileSeq}">
					          <div class="modal-dialog">
					            <div class="modal-content">
					              <div class="modal-header">
					                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					                	<span aria-hidden="true"></span>&times;
					                </button>
					                <h4 class="modal-title" th:text="${attachFile.orgName}"></h4>
					              </div>
					              <div class="modal-body">
					                <img th:src="@{/common/file/} + ${attachFile.fileSeq}" onerror="alert('no-image');" class="img-responsive" />
					              </div>
<!--
					              <div class="modal-footer">
					                <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Close</button>
					                <button type="button" class="btn btn-primary">Save changes</button>
					              </div>
-->
					            </div>
					            <!-- /.modal-content -->
					          </div>
					          <!-- /.modal-dialog -->
					        </div>
					        <!-- /.modal -->

						</li>
					</ul>
					<!-- 파일업로드 처리 //-->

                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">등록일시</label>
                  <div class="col-sm-2">
                  	<input type="text" class="form-control" id="_regDate" name="_regDate" readonly="readonly" th:value="${#dates.format(ad.regDate, 'yyyy-MM-dd HH:mm')}" />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">삭제여부</label>
                  <div class="col-sm-9">
	                <div class="checkbox">
	                  <label>
	                    <input type="checkbox" id="cb-del-yn"> 삭제 여부 (체크 시 해당 광고 미노출)
	                    <input type="hidden" id="delYn" name="delYn" th:value="${ad.delYn}" />
	                  </label>
	                </div>
                  </div>
                </div>
              </div>
              <!-- /.box-body -->

              <div class="box-footer">
              	<div class="col-sm-offset-2 col-sm-9">
              	    <button type="submit" class="btn btn-primary pull-right">저장</button>
              	    <a href="javascript:history.back();" class="btn btn-info">광고 목록</a>
              	</div>
              </div>

              <input type="hidden" id="startDate" name="startDate" value="" />
              <input type="hidden" id="endDate" name="endDate" value="" />
            </form>
          </div>
          <!-- /.box -->

        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->
    </section>
    <!-- /.content -->

	<script type="text/javascript" th:inline="javascript">
	/*<![CDATA[*/
		$(function () {
		    $("[data-mask]").inputmask();
		});
	/*]]>*/
	</script>

  </div>
  <!-- /.content-wrapper -->
  <!-- 본문 영역 //-->
</body>
</html>
